-- Set default database
USE pc_build;

-- Rename column `socket_per_cpu` to `socket_type` on table `motherboard`
ALTER TABLE motherboard 
  RENAME COLUMN socket_per_cpu TO socket_type;
  
-- Create column `tdp` on table `video_card`
ALTER TABLE video_card 
  ADD COLUMN tdp VARCHAR(50) DEFAULT NULL;
  
-- randomly populate column `tdp` on table `video_card`
UPDATE video_card
SET tdp = (CASE floor(rand()*9) 
         WHEN 0 THEN '65 W'
         WHEN 1 THEN '65 W'
         WHEN 2 THEN '65 W'
         WHEN 3 THEN '95 W'
         WHEN 4 THEN '95 W'
         WHEN 5 THEN '35 W'
         WHEN 6 THEN '80 W'
         WHEN 7 THEN '125 W'
         WHEN 8 THEN '140 W'
         END);

-- Change columns order on table `video_card`
ALTER TABLE video_card 
  MODIFY color VARCHAR(50) DEFAULT NULL AFTER tdp;
 
-- Remove leading and trailing spaces
UPDATE external_harddrive
SET interface = trim(interface);

-- Create column `ram_gen` on table `memory`
ALTER TABLE memory 
  ADD COLUMN ram_gen VARCHAR(5) DEFAULT NULL;

-- Change columns order on table `memory`
ALTER TABLE memory 
 MODIFY ram_gen VARCHAR(5) DEFAULT NULL AFTER product_id;
  
-- Split column `speed` data on table `memory`
UPDATE memory
SET ram_gen = SUBSTRING_INDEX(speed, '-', 1), 
   speed = SUBSTRING_INDEX(speed, '-', -1);

-- Alter column `speed` on table `memory`
ALTER TABLE memory 
  CHANGE COLUMN speed speed SMALLINT UNSIGNED DEFAULT NULL;
  
-- Create column `ram_gen` on table `motherboard`
ALTER TABLE motherboard 
  ADD COLUMN ram_gen VARCHAR(5) DEFAULT NULL;

-- Change columns order on table `motherboard`
ALTER TABLE motherboard 
 MODIFY ram_gen VARCHAR(5) DEFAULT NULL AFTER form_factor;
 
-- randomly populate column `ram_gen` on table `motherboard`
UPDATE motherboard
SET ram_gen = (CASE floor(rand()*9) 
         WHEN 0 THEN 'DDR4'
         WHEN 1 THEN 'DDR4'
         WHEN 2 THEN 'DDR4'
         WHEN 3 THEN 'DDR4'
         WHEN 4 THEN 'DDR3'
         WHEN 5 THEN 'DDR3'
         WHEN 6 THEN 'DDR3'
         WHEN 7 THEN 'DDR3'
         WHEN 8 THEN 'DDR2'
         END);
		 
UPDATE motherboard
SET ram_gen = (CASE floor(rand()*9) 
         WHEN 0 THEN 'DDR4'
         WHEN 1 THEN 'DDR4'
         WHEN 2 THEN 'DDR4'
         WHEN 3 THEN 'DDR4'
         WHEN 4 THEN 'DDR3'
         WHEN 5 THEN 'DDR3'
         WHEN 6 THEN 'DDR3'
         WHEN 7 THEN 'DDR3'
         WHEN 8 THEN 'DDR2'
         END)
WHERE ram_gen = 'DDR2';

-- Rename column `tdp` to `tdp_wattage` on table `video_card`
ALTER TABLE video_card 
  RENAME COLUMN tdp TO tdp_wattage;
  
-- Split column `tdp_wattage` data on table `video_card`
UPDATE video_card
SET tdp_wattage = SUBSTRING_INDEX(tdp_wattage, '-', 1);

-- Alter column `tdp_wattage` on table `video_card`
ALTER TABLE video_card 
  CHANGE COLUMN tdp_wattage tdp_wattage SMALLINT UNSIGNED DEFAULT NULL;
  
-- Change column `color` order on table `cpu_cooler`
ALTER TABLE cpu_cooler 
 MODIFY color VARCHAR(50) DEFAULT NULL AFTER radiator_size;
  
-- Rename column `tdp` to `tdp_wattage` on table `cpu`
ALTER TABLE cpu 
  RENAME COLUMN tdp TO tdp_wattage;
  
-- Split column `tdp_wattage` data on table `cpu`
UPDATE cpu
SET tdp_wattage = SUBSTRING_INDEX(tdp_wattage, '-', 1);

-- Alter column `tdp_wattage` on table `cpu`
ALTER TABLE cpu 
  CHANGE COLUMN tdp_wattage tdp_wattage SMALLINT UNSIGNED DEFAULT NULL; 
 
-- Create column `socket_type` on table `cpu`
ALTER TABLE cpu 
  ADD COLUMN socket_type VARCHAR(50) DEFAULT NULL;

-- Change columns order on table `cpu`
ALTER TABLE cpu 
 MODIFY socket_type VARCHAR(50) DEFAULT NULL AFTER product_id;
 
-- Populate column `socket_type` on table `cpu`
UPDATE cpu
SET socket_type = CASE 
   WHEN product_id IN (276312, 276304, 276306, 276307, 276308, 276309, 
      275101, 275102, 275106, 275107, 275110, 275111, 275554, 275556, 
      275112, 275113, 275117, 275120, 275123, 275124, 275548, 275549, 
      275126, 275127, 275144, 275147, 275153, 275154, 275157, 275167, 
      275172, 275177, 275183, 275185, 275186, 275202, 275206, 275207, 
      275209, 275211, 275227, 275229, 275233, 275236, 275242, 275243, 
      275244, 275247, 275249, 275264, 275267, 275273, 275276, 275287, 
      275290, 275291, 275292, 275297, 275306, 275312, 275315, 275326, 
      275329, 275335, 275336, 275339, 275341, 275349, 275351, 275354, 
      275355, 275356, 275359, 275361, 275362, 275366, 275368, 275374, 
      275379, 275382, 275384, 275386, 275387, 275389, 275393, 275394, 
      275399, 275401, 275406, 275407, 275412, 275415, 275416, 275418, 
      275426, 275427, 275430, 275431, 275435, 275439, 275443, 275444, 
      275448, 275451, 275453, 275458, 275460, 275464, 275468, 275471, 
      275481, 275482, 275483, 275484, 275492, 275494, 275497, 275501, 
      275503, 275515, 275521, 275525, 275526, 275528, 275537, 275540, 
      275568, 275573, 275575, 275576, 275577, 275581, 275603, 275606, 
      275608, 275614, 275615, 275616, 275618, 275628, 275642, 275646, 
      275647, 275654, 275659, 275660, 275664, 275665, 275667, 275671, 
      275676, 275678, 275680, 275682, 275683, 275692, 275701, 275703, 
      275704, 275705, 275714, 275730, 275733, 275734, 275735, 275742, 
      275744, 275745, 275746, 275748, 275750, 275759, 275761, 275765, 
      275771, 275785, 275786, 275787, 275789, 275790, 275803, 275814, 
      275828, 275834, 275842, 275843, 275851, 275853, 275860, 275861, 
      275862, 275863, 275864, 275865, 275871, 275872, 275873, 275874, 
      275878, 275881, 275886, 275891, 275894, 275898, 275899, 275906, 
      275910, 275911, 275913, 275915, 275916, 275919, 275920, 275923, 
      275933, 275935, 275936, 275941, 275943, 275944, 275945, 275946, 
      275956, 275957, 275958, 275961, 275962, 275967, 275969, 275973, 
      275975, 275992, 275993, 275995, 276005, 276006, 276008, 276009, 
      276011, 276012, 276013, 276014, 276015, 276016, 276019, 276020, 
      276021, 276025, 276032, 276033, 276037, 276043, 276045, 276046, 
      276047, 276048, 276050, 276051, 276052, 276053, 276054, 276065, 
      276072, 276073, 276074, 276075, 276076, 276090, 276091, 276093, 
      276094, 276095, 276096, 276099, 276114, 276115, 276116, 276117, 
      276128, 276129, 276130, 276131, 276134, 276135, 276136, 276137, 
      276140, 276141, 276144, 276146, 276147, 276150, 276155, 276156, 
      276157, 276158, 276159, 276160, 276175, 276182, 276183, 276184, 
      276186, 276187, 276188, 276195, 276198, 276199, 276200, 276201, 
      276202, 276204, 276205, 276206, 276207, 276212, 276218, 276221, 
      276222, 276223, 276226, 276228, 276229, 276230, 276231, 276232, 
      276241, 276254, 276255, 276256, 276257, 276263, 276266, 276268, 
      276269, 276270, 276271, 276272, 276273, 276274, 276275, 276281, 
      276282, 276283, 276284, 276286, 276288, 276289, 276290, 276303, 
      276310, 276311, 276313, 276313) THEN 'AM4'
   WHEN product_id IN ((275105, 275108, 275115, 275121, 275122, 275125, 
      275128, 275130, 275131, 275132, 275133, 275134, 275136, 275139, 
      275140, 275142, 275143, 275145, 275146, 275148, 275150, 275152, 
      275159, 275160, 275163, 275165, 275166, 275169, 275170, 275171, 
      275174, 275175, 275176, 275178, 275179, 275181, 275182, 275184, 
      275188, 275189, 275190, 275191, 275194, 275195, 275196, 275199, 
      275203, 275204, 275205, 275208, 275212, 275213, 275215, 275216, 
      275217, 275222, 275223, 275224, 275225, 275226, 275228, 275234, 
      275235, 275237, 275238, 275239, 275241, 275245, 275246, 275252, 
      275253, 275254, 275255, 275256, 275257, 275260, 275261, 275263, 
      275265, 275266, 275268, 275269, 275271, 275272, 275274, 275275, 
      275279, 275280, 275281, 275283, 275284, 275286, 275294, 275295, 
      275296, 275298, 275300, 275303, 275304, 275305, 275308, 275310, 
      275311, 275313, 275314, 275316, 275318, 275319, 275320, 275322, 
      275324, 275325, 275330, 275331, 275332, 275334, 275338, 275340, 
      275342, 275344, 275346, 275347, 275352, 275353, 275358, 275360, 
      275363, 275364, 275365, 275369, 275370, 275371, 275372, 275373, 
      275375, 275378, 275383, 275385, 275388, 275390, 275396, 275398, 
      275400, 275402, 275411, 275413, 275417, 275419, 275421, 275422, 
      275423, 275424, 275425, 275432, 275434, 275436, 275437, 275438, 
      275445, 275446, 275450, 275454, 275459, 275461, 275462, 275463, 
      275466, 275467, 275470, 275473, 275474, 275476, 275477, 275479, 
      275480, 275486, 275487, 275490, 275491, 275495, 275502, 275505, 
      275506, 275508, 275518, 275519, 275527, 275529, 275532, 275534, 
      275535, 275539, 275542, 275544, 275545, 275546, 275551, 275552, 
      275553, 275557, 275563, 275564, 275592, 275595, 275598, 275599, 
      275600, 275604, 275605, 275609, 275610, 275612, 275620, 275621, 
      275622, 275623, 275624, 275625, 275629, 275630, 275631, 275633, 
      275634, 275636, 275637, 275639, 275641, 275655, 275656, 275657, 
      275666, 275674, 275679, 275685, 275687, 275688, 275699, 275700, 
      275706, 275708, 275711, 275717, 275720, 275723, 275724, 275725, 
      275726, 275727, 275729, 275731, 275732, 276300, 276301, 276302, 
      275736, 275737, 275739, 275740, 275741, 275747, 275754, 275755, 
      275756, 275768, 275769, 275770, 275773, 275774, 275775, 275776, 
      275779, 275780, 275782, 275783, 275784, 275791, 275797, 275798, 
      275799, 275800, 275801, 275802, 275804, 275805, 275806, 275807, 
      275809, 275810, 275811, 275818, 275820, 275822, 275823, 275824, 
      275826, 275827, 275829, 275832, 275838, 275840, 275844, 275847, 
      275850, 275856, 275859, 275866, 275868, 275869, 275870, 275875, 
      275876, 275882, 275887, 275888, 275889, 275890, 275893, 275904, 
      275905, 275909, 275912, 275921, 275922, 275934, 275937, 275938, 
      275942, 275947, 275948, 275959, 275960, 275963, 275965, 275979, 
      275980, 275981, 275982, 275988, 275990, 275996, 276000, 276001, 
      276002, 276003, 276004, 276010, 276022, 276024, 276028, 276029, 
      276030, 276035, 276036, 276038, 276039, 276040, 276041, 276058, 
      276060, 276061, 276062, 276066, 276067, 276079, 276080, 276081, 
      276082, 276083, 276084, 276085, 276086, 276088, 276106, 276107, 
      276112, 276121, 276122, 276123, 276124, 276125, 276126, 276127, 
      276145, 276151, 276154, 276166, 276167, 276169, 276171, 276172, 
      276173, 276174, 276176, 276177, 276178, 276179, 276180, 276181, 
      276189, 276190, 276197, 276208, 276213, 276215, 276216, 276217, 
      276237, 276239, 276240, 276242, 276243, 276244, 276245, 276246, 
      276247, 276248, 276249, 276250, 276251, 276252, 276253, 276296, 
      276298, 276299) THEN 'BGA1440'
   WHEN product_id IN (275103, 275104, 275114, 275116, 275149, 275155,
      275180, 275248, 275259, 275301, 275328, 275367, 275496) THEN 'FP5'
   WHEN product_id IN (275109, 275118, 275129, 275138, 275158, 275161, 
      275197, 275200, 275201, 275214, 275218, 275219, 275230, 275250, 
      275262, 275282, 275285, 275288, 275289, 275299, 275302, 276305, 
      275317, 275323, 275327, 275348, 275350, 275376, 275391, 275392, 
      275395, 275397, 275403, 275404, 275405, 275408, 275409, 275410, 
      275414, 275420, 275429, 275433, 275440, 275441, 275442, 275449, 
      275452, 275457, 275469, 275472, 275478, 275485, 275488, 275493, 
      275499, 275500, 275509, 275510, 275513, 275516, 275517, 275522, 
      275523, 275524, 275530, 275533, 275536, 275541, 275543, 275547, 
      275550, 275555, 275559, 275562, 275565, 275566, 275567, 275569, 
      275570, 275571, 275572, 275574, 275580, 275583, 275586, 275587, 
      275589, 275590, 275593, 275594, 275596, 275601, 275607, 275619, 
      275626, 275632, 275635, 275638, 275640, 275643, 275648, 275649, 
      275650, 275651, 275652, 275653, 275658, 275661, 275662, 275663, 
      275669, 275672, 275673, 275675, 275681, 275684, 275686, 275689, 
      275691, 275694, 275696, 275697, 275698, 275707, 275709, 275710, 
      275715, 275716, 275718, 275719, 275721, 275728, 275738, 275749, 
      275751, 275752, 275753, 275757, 275758, 275760, 275762, 275763, 
      275764, 275766, 275767, 275772, 275778, 275781, 275788, 275792, 
      275793, 275794, 275796, 275808, 275813, 275815, 275816, 275817, 
      275819, 275831, 275841, 275845, 275849, 275852, 275854, 275857, 
      275858, 275867, 275877, 275883, 275884, 275895, 275900, 275901, 
      275907, 275908, 275918, 275925, 275927, 275928, 275929, 275930, 
      275931, 275932, 275939, 275940, 275950, 275953, 275954, 275966, 
      275970, 275971, 275974, 275977, 275978, 275985, 275989, 275994, 
      276007, 276017, 276018, 276023, 276031, 276042, 276049, 276055, 
      276056, 276057, 276059, 276063, 276064, 276068, 276070, 276087, 
      276089, 276092, 276097, 276098, 276100, 276102, 276103, 276104, 
      276105, 276109, 276110, 276138, 276139, 276142, 276143, 276148, 
      276152, 276153, 276192, 276193, 276209, 276210, 276211, 276220, 
      276224, 276225, 276260, 276261, 276262, 276264, 276280) THEN 'LGA1151'
   WHEN product_id IN (275151, 275162, 275187, 275210, 275221, 275231, 
      275232, 275240, 275251, 275258, 275270, 275277, 275278, 275293, 
      275307, 275309, 275321, 275333, 275337, 275343, 275345, 275357, 
      275377, 275380, 275381, 275428, 275455, 275465, 275475, 275489, 
      275498, 275504, 275507, 275511, 275512, 275514, 275520, 275531, 
      275538, 275558, 275560, 275561, 275578, 275579, 275582, 275584, 
      275585, 275588, 275597, 275611, 275613, 275617, 275627, 275644, 
      275645, 275668, 275670, 275677, 275690, 275693, 275695, 275702, 
      275712, 275713, 275722, 275743, 275777, 275795, 275812, 275821, 
      275825, 275830, 275833, 275835, 275836, 275837, 275839, 275846, 
      275848, 275855, 275879, 275880, 275885, 275892, 275896, 275897, 
      275902, 275903, 275914, 275917, 275924, 275926, 275949, 275951, 
      275952, 275955, 275964, 275968, 275972, 275976, 275983, 275984, 
      275986, 275987, 275991, 275997, 275998, 275999, 276026, 276027, 
      276034, 276044, 276069, 276071, 276077, 276078, 276101, 276108, 
      276111, 276113, 276118, 276119, 276120, 276132, 276133, 276149, 
      276161, 276162, 276163, 276164, 276165, 276168, 276170, 276185, 
      276191, 276194, 276196, 276203, 276214, 276219, 276227, 276233, 
      276234, 276235, 276236, 276238, 276258, 276259, 276265, 276267, 
      276276, 276277, 276278, 276279, 276285, 276287, 276291, 276292, 
      276293, 276294, 276295, 276297) THEN 'LGA1200'
   WHEN product_id IN (275141, 275193, 275220) THEN 'LGA2066'
   WHEN product_id IN (275119, 275135) THEN 'sTRX4'
   WHEN product_id IN (275137, 275156, 275164, 275168, 275173, 275192, 
      275198, 275447, 275456, 275591, 275602) THEN 'TR4'
   END
WHERE socket_type IS NULL;

-- Create and populate column `mode` on table `cpu`
ALTER TABLE cpu 
  ADD COLUMN mode ENUM('64-bit','32-bit','32/64-bit') DEFAULT '32/64-bit';
  
-- Alter column `mode` on table `cpu`
ALTER TABLE cpu 
  MODIFY COLUMN mode ENUM('64-bit','32-bit','32/64-bit') DEFAULT NULL;

-- Alter column `mode` on table `cpu`
ALTER TABLE cpu 
  MODIFY COLUMN mode ENUM('64-bit','32-bit','32/64-bit') DEFAULT NULL AFTER boost_clock;

-- Split column `wattage` data on table `power_supply`
UPDATE power_supply
SET wattage = SUBSTRING_INDEX(wattage, ' ', 1);

-- Alter column `wattage` on table `power_supply`
ALTER TABLE power_supply 
  CHANGE COLUMN wattage wattage SMALLINT UNSIGNED DEFAULT NULL;
  
-- Rename column `wattage` to `total_wattage` on table `power_supply`
ALTER TABLE power_supply 
  RENAME COLUMN wattage TO total_wattage;

-- Create column `form_factor` on table `pc_case`
ALTER TABLE pc_case 
  ADD COLUMN form_factor VARCHAR(50) DEFAULT NULL;

-- Change columns order on table `pc_case`
ALTER TABLE pc_case 
 MODIFY form_factor VARCHAR(50) DEFAULT NULL AFTER case_type;
 
-- Split column `case_type` on table `pc_case`
UPDATE pc_case
SET form_factor = CASE
      WHEN case_type LIKE 'Mini ITX%' THEN 'Mini ITX'
      WHEN case_type LIKE 'HTPC' THEN 'Mini ITX'
      ELSE SUBSTRING_INDEX(case_type, ' ', 1) END,
   case_type = CASE
      WHEN case_type LIKE '%slim' THEN 'Slim Tower'
      WHEN case_type LIKE '%desktop' THEN 'Desktop'
      WHEN case_type = 'Mini ITX Tower' THEN 'Mini Tower'
      ELSE SUBSTRING_INDEX(case_type, ' ', -2) END
WHERE form_factor IS NULL;

-- Create column `os_type` on table `build`
ALTER TABLE build 
  ADD COLUMN os_type ENUM('Windows','iOS','Android','Linux') DEFAULT NULL;

-- Create column `socket_type` on table `build`
ALTER TABLE build 
  ADD COLUMN socket_type VARCHAR(50) DEFAULT NULL;

-- Create column `form_factor` on table `build`
ALTER TABLE build 
  ADD COLUMN form_factor VARCHAR(50) DEFAULT NULL;

-- Create column `ram_gen` on table `build`
ALTER TABLE build 
  ADD COLUMN ram_gen VARCHAR(5) DEFAULT NULL;

-- Create column `ram_slots` on table `build`
ALTER TABLE build 
  ADD COLUMN ram_slots TINYINT DEFAULT NULL;

-- Create column `total_tdp` on table `build`
ALTER TABLE build 
  ADD COLUMN total_tdp SMALLINT UNSIGNED DEFAULT NULL;

-- Create column `cpu_tdp` on table `build`
ALTER TABLE build 
  ADD COLUMN cpu_tdp SMALLINT UNSIGNED DEFAULT NULL;

-- Create column `video_card_tdp` on table `build`
ALTER TABLE build 
  ADD COLUMN video_card_tdp SMALLINT UNSIGNED DEFAULT NULL;

-- Change columns order on table `build`
ALTER TABLE build 
 MODIFY created_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP AFTER video_card_tdp;
ALTER TABLE build 
 MODIFY updated_data TIMESTAMP NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP AFTER created_date;

